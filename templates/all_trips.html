{% extends 'base.html' %}
{% block title %}{{ user.name|title }}'s Trips{% endblock %}
{% block style %}
<link rel="stylesheet" href="/static/css/all_trips.css">
{% endblock %}
{% block navbar %}
    <nav class="navbar navbar-default navbar-fixed-top">
    <div id= "homenavbar"class="container-fluid">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" id="collapse-btn" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#homenavbarcollapse" aria-expanded="false">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">journeyteller <i class="fa fa-compass"></i></a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="homenavbarcollapse">

        <ul class="nav navbar-nav navbar-right">
            <li><a href="/">ABOUT</a></li>
            <li><a href="/logout">LOG OUT</a></li>
        </ul>
      </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
  </nav>
  {% endblock %}
{% block content %}
  <div class="container">
    <div class="row">
      <div class="col-xs-12 text-center">
        <h1>All Trips, by <em>{{ user.name|title }}</em></h1>
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12 text-center" id="form-row">
        <button id="show-form-btn">Show Create Trip Form</button>
        <form id='create-trip'>
          <label for='tripname'>Name your trip: </label>
          <input type='text' name='tripname' id='tripname' required><br>
          <label for='trip-loc-search'>Where did you go?</label>
          <input id="trip-loc-search" name="trip-loc-search" type="text" placeholder="Search Box" required><br>
          <label for="from">Traveled From</label>
          <input type="text" id="from" name="from" required>
          <label for="to">to</label>
          <input type="text" id="to" name="to" required><br>
          <input type='submit' value='CREATE NEW TRIP' id='submit-trip'><br>
          <button id="hide-form-btn">Hide Form</button>
        </form>
      </div>
    </div>
     
    <div class="row">
      <div class="col-xs-12 text-center">
        {% for trip in user_trips %}
            <a href='/create_trip/{{ user.username }}/{{ trip.trip_id }}' class="trip-link"><h3>{{ trip.trip_name }}: <em>{{trip.start_date.strftime("%B %d, %Y")}} to {{trip.end_date.strftime("%B %d, %Y")}}</em></h3></a>
        {% endfor %}
      </div> 
    </div>

  </div>
{% endblock %}

{% block scripts %}
<script>
  $( function() {
    var dateFormat = "mm/dd/yy",
      from = $( "#from" )
        .datepicker({
          defaultDate: "+1w",
          changeMonth: true,
          changeYear: true,
          numberOfMonths: 1
        })
        .on( "change", function() {
          to.datepicker( "option", "minDate", getDate( this ) );
        }),
      to = $( "#to" ).datepicker({
        defaultDate: "+1w",
        changeMonth: true,
        changeYear: true,
        numberOfMonths: 1
        
      })
      .on( "change", function() {
        from.datepicker( "option", "maxDate", getDate( this ) );
      });

    function getDate( element ) {
      var date;
      try {
        date = $.datepicker.parseDate( dateFormat, element.value );
      } catch( error ) {
        date = null;
      }

      return date;
    }
  } );
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDv88WJq0QSZ8YNl9SUyZRn4zPc0pk9RE0&
libraries=places&callback=tripLocSearch" async defer></script>
<script src="/static/js/trip_location_searchbar.js"></script>
{% endblock %}
